# MyPten

## Настройка модели игрока

1. Импортируй ассет **asoliddev - Low Poly Fantasy Warrior** в папку проекта (любой каталог внутри `Assets`).
2. Открой нужную сцену и выбери объект с компонентом `BattleManager`.
3. В инспекторе в блоке **Player Avatar** укажи поле **Player Avatar Prefab** — перетащи туда нужный префаб воина.
4. Скрипт автоматически опускает модель до земли по габаритам рендера и капсулы. Если требуется своё позиционирование, отключи галочку **Auto Align Player Avatar** и задай смещение вручную через поле **Player Avatar Offset**.
5. В каталоге `Assets/Resources/Blink` размести анимации из пакета Blink. Скрипт `PlayerAnimationDriver` ищет до 32 клипов с названиями:
   - Idle, Combat Idle, Run Forward, Sprint, Run Left, Run Right, Strafe Left, Strafe Right
   - Run Backward, Run Backward Left, Run Backward Right, Jump, Jump while running, Falling Loop
   - Roll Forward/Left/Right/Backward, Punch Left/Right, One-Handed и Two-Handed Melee Attack
   - Magic Attack, Spell Casting Loop, Bow Shot, Buff / Boost, Get Hit, Blocking Loop, Stunned Loop, Death, Gathering, Mining
   Пропущенные клипы можно назначить вручную в инспекторе.
6. Убедись, что в префабе героя есть компонент `Animator`. В этом случае `PlayerAnimationDriver` построит собственный миксер, который выбирает нужные беговые, стрейфовые и обратные клипы, а также отдельный слой для действий (удары, заклинания, перекаты). Если нужных анимаций нет, компонент откатится к классической схеме с параметрами **Speed** и **IsMoving** — их имена можно изменить в инспекторе объекта `Player`.
7. Для ручного вызова анимаций действий используй метод `PlayAction(AnimationKey key)` компонента `PlayerAnimationDriver` — он мягко включает клип на верхнем слое. Зацикленные действия (`SpellCastingLoop`, `BlockingLoop`, `StunnedLoop`, `Gathering`, `Mining`) отключаются методом `StopAction`.
8. Для корректного выбора ударов отметь тип оружия в `ItemDefinition` (поле **Weapon Archetype**): `OneHandedBlade` включает одиночный укол, `TwoHandedAxe` — широкую рубящую дугу.

Если префаб не задан, игра автоматически создаст капсулу-заглушку, поэтому проект остаётся рабочим даже без импортированного ассета.

## Управление камерой и героем

* Камера орбитирует вокруг персонажа: зажмите правую кнопку мыши и перемещайте курсор, чтобы повернуть обзор, а колёсиком можно плавно приближать или отдалять камеру.
* Перемещение героя теперь привязано к направлению взгляда камеры — при зажатой клавише `W` персонаж бежит туда, куда направлен объектив.
* Прыжок по пробелу запускает экшен-анимацию (отдельно для прыжка с места и в движении), сохраняя плавное ускорение и разворот к направлению бега.
* Левая кнопка мыши запускает систему ближнего боя: одноручное оружие бьёт по одной цели по направлению взгляда, а двуручное топор поражает несколько противников перед героем по дуге.
* В инспекторе `PlayerController` можно указать два клипа атак — для легкого (одноручного) и тяжелого (двуручного) оружия. Скрипт `SimpleAttack` автоматически выбирает нужную анимацию и форму удара, ориентируясь на тип экипированного оружия в инвентаре.

## Таланты: восстановление ресурсов

1. После обновления проекта открой его в Unity — редактор автоматически запустит миграцию `TalentRequirementCleanup`.
2. Скрипт удалит устаревшие ScriptableObject-ассеты требований и перенесёт их данные во встроенный список `requirements` каждого узла.
3. Если окно консоли сообщает об удалении ассетов, по завершении нажмите **File → Save Project**, чтобы зафиксировать изменения.
4. При повторном запуске миграция не будет выполняться снова. Чтобы принудительно перезапустить её, очистите папку `Library` либо удалите ключ `Begin.Talents.RequirementCleanup.v2` через `SessionState`.
5. После миграции убедитесь, что `Resources/Talents/CompleteTree.asset` успешно загружается и панель талантов отображает полный список навыков.
